define("block_a2nb/export",["jquery","core/notification"],(function($,Notification){async function generateNotebook(name,description,instructions){const pyodide=await async function(){return window.pyodide||(Notification.addNotification({message:"Loading in browser Python environment...",type:"info"}),window.pyodide=await loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.25.1/full/"}),await window.pyodide.loadPackage("micropip"),await window.pyodide.runPythonAsync('\n                import micropip\n                await micropip.install("nbformat")\n            ')),window.pyodide}(),safeName=name.replace(/[^\w\s-]/g,"").replace(/\s+/g,"_"),temp=document.createElement("div");temp.innerHTML=instructions||"";const codeBlocks=[];temp.querySelectorAll("pre").forEach((pre=>{const code=(pre.textContent||"").trim();code&&codeBlocks.push(code),pre.remove()}));const cleanedInstructions=temp.innerHTML,codesJson=JSON.stringify(codeBlocks),pythonCode=`\nimport nbformat as nbf\nimport json\n\nnb = nbf.v4.new_notebook()\ncells = []\n\ncells.append(nbf.v4.new_markdown_cell('### Assignment: ${name}\\n>This notebook was generated from Moodle A2NB Plugin.'))\ncells.append(nbf.v4.new_markdown_cell('#### Description:\\n${description}'))\ncells.append(nbf.v4.new_markdown_cell("""#### Instructions:\\n${cleanedInstructions}"""))\n\n\ncodes = json.loads(${JSON.stringify(codesJson)})\nfor code in codes:\n    cells.append(nbf.v4.new_code_cell(code))\n\n\nnb.cells = cells\nnb_str = nbf.writes(nb)\nnb_str\n        `;try{const notebookStr=await pyodide.runPythonAsync(pythonCode),blob=new Blob([notebookStr],{type:"application/json"}),link=document.createElement("a");link.href=URL.createObjectURL(blob),link.download=`${safeName}.ipynb`,document.body.appendChild(link),link.click(),document.body.removeChild(link)}catch(error){Notification.exception(error)}}return{init:function(){$(document).on("click",".create-ipynb",(function(){const name=$(this).data("name"),description=$(this).data("description"),instructions=$(this).data("instructions");name&&description&&instructions?(Notification.addNotification({message:`Generating notebook for "${name}"...`,type:"info"}),generateNotebook(name,description,instructions)):Notification.alert("Assignment infos not fully provided.")}))}}}));

//# sourceMappingURL=export.min.js.map